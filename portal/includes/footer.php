<div class="modal fade" id="viewClientModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content glass-modal">
            <div class="modal-header border-bottom justify-content-between border-white border-opacity-10">
                <div>
                    <h5 class="modal-title text-white fw-bold mb-0" id="view_company_name">Company Name</h5>
                    <span class="badge bg-gold text-dark mt-1" id="view_client_id">#ID</span>
                </div>
                <div class="d-flex gap-2">
                    <a href="#" id="view_edit_btn" class="btn btn-sm btn-outline-warning d-flex align-items-center">
                        <i class="bi bi-pencil-square me-2"></i> Edit Client
                    </a>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
            </div>

            <div class="modal-body p-4">
                <div class="row">
                    <div class="col-md-6 border-end border-white border-opacity-10">
                        <h6 class="view-section-title">Contact Information</h6>

                        <div class="view-label">Client Name</div>
                        <div class="view-value" id="v_name">-</div>

                        <div class="view-label">Phone Number</div>
                        <div class="view-value" id="v_phone">-</div>

                        <div class="view-label">Email Address</div>
                        <div class="view-value" id="v_email">-</div>

                        <div class="view-label">Trade Name App</div>
                        <div class="view-value" id="v_trade">-</div>
                    </div>

                    <div class="col-md-6 ps-md-4">
                        <h6 class="view-section-title">Financial Overview</h6>

                        <div class="row">
                            <div class="col-6">
                                <div class="view-label">Contract Value</div>
                                <div class="view-value text-gold" id="v_contract">-</div>
                            </div>
                            <div class="col-6">
                                <div class="view-label">Paid Amount</div>
                                <div class="view-value text-success" id="v_paid">-</div>
                            </div>
                            <div class="col-12">
                                <div class="view-label">Due Balance</div>
                                <div class="view-value" id="v_due">-</div>
                            </div>
                        </div>

                        <h6 class="view-section-title mt-4">License Scope</h6>
                        <div id="badge_scope" class="view-badge badge-default">-</div>
                        <div id="note_scope" class="wf-note mt-2" style="display:none;">-</div>
                    </div>
                </div>
                <div class="mt-4">
                    <h6 class="view-section-title"
                        style="color:#D4AF37;font-size:0.8rem;text-transform:uppercase;margin-bottom:15px;">
                        <i class="bi bi-diagram-3 me-2"></i>Workflow Progress
                    </h6>

                    <div id="workflow_grid" class="row g-3 mt-2">
                        <div class="col-md-4 col-6">
                            <div class="view-label">Hire Foreign Co.</div>
                            <div id="badge_hire" class="view-badge badge-default">-</div>
                        </div>
                        <div class="col-md-4 col-6">
                            <div class="view-label">MISA App</div>
                            <div id="badge_misa" class="view-badge badge-default">-</div>
                        </div>
                        <div class="col-md-4 col-6">
                            <div class="view-label">SBC App</div>
                            <div id="badge_sbc" class="view-badge badge-default">-</div>
                        </div>
                        <div class="col-md-4 col-6">
                            <div class="view-label">Art. Association</div>
                            <div id="badge_art" class="view-badge badge-default">-</div>
                        </div>
                        <div class="col-md-4 col-6">
                            <div class="view-label">Qiwa</div>
                            <div id="badge_qiwa" class="view-badge badge-default">-</div>
                        </div>
                        <div class="col-md-4 col-6">
                            <div class="view-label">Muqeem</div>
                            <div id="badge_muqeem" class="view-badge badge-default">-</div>
                        </div>
                        <div class="col-md-4 col-6">
                            <div class="view-label">GOSI</div>
                            <div id="badge_gosi" class="view-badge badge-default">-</div>
                        </div>
                        <div class="col-md-4 col-6">
                            <div class="view-label">Chamber of Comm.</div>
                            <div id="badge_coc" class="view-badge badge-default">-</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="glass-calendar-popup" id="rooqDatePicker">
    <div class="calendar-header">
        <button type="button" class="calendar-btn" id="dpPrevMonth" title="Previous Month"><i class="bi bi-chevron-left"></i></button>
        <h5 id="dpMonthYear">Month Year</h5>
        <button type="button" class="calendar-btn" id="dpNextMonth" title="Next Month"><i class="bi bi-chevron-right"></i></button>
    </div>
    
    <div class="calendar-grid">
        <div class="calendar-day-name">Su</div>
        <div class="calendar-day-name">Mo</div>
        <div class="calendar-day-name">Tu</div>
        <div class="calendar-day-name">We</div>
        <div class="calendar-day-name">Th</div>
        <div class="calendar-day-name">Fr</div>
        <div class="calendar-day-name">Sa</div>
    </div>
    
    <div class="calendar-grid" id="dpCalendarDays">
        </div>
    <div class="mt-3 pt-3 border-top border-secondary border-opacity-25 d-flex gap-2 justify-content-between" id="dpActionButtons">
        <button type="button" class="btn btn-sm btn-outline-light flex-grow-1 fw-bold" id="dpBtnToday" style="font-size: 0.75rem;">Today</button>
        <button type="button" class="btn btn-sm btn-outline-light flex-grow-1 fw-bold" id="dpBtnMonth" style="font-size: 0.75rem;">This Month</button>
        <button type="button" class="btn btn-sm btn-outline-light flex-grow-1 fw-bold" id="dpBtnYear" style="font-size: 0.75rem;">This Year</button>
    </div>
</div>


<script src="<?php echo BASE_URL; ?>assets/js/bootstrap.bundle.min.js"></script>
<script src="<?php echo BASE_URL; ?>assets/js/all.min.js"></script>
<script src="<?php echo BASE_URL; ?>assets/js/main.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var toggleBtn = document.getElementById("sidebarToggle");
        var sidebar = document.getElementById("portalSidebar");

        if (toggleBtn && sidebar) {
            toggleBtn.addEventListener("click", function (e) {
                e.preventDefault(); // Stop page from jumping
                sidebar.classList.toggle("show"); // Add/Remove 'show' CSS class
            });

            // Optional: Close sidebar if clicking outside on mobile
            document.addEventListener("click", function (e) {
                if (window.innerWidth < 992 &&
                    !sidebar.contains(e.target) &&
                    !toggleBtn.contains(e.target)) {
                    sidebar.classList.remove("show");
                }
            });
        } else {
            console.error("Sidebar or Toggle Button ID not found!");
        }
    });
</script>
<script>
// --- LIVE NOTIFICATION AUTO-UPDATER ---
function checkLiveNotifications() {
    fetch('<?php echo BASE_URL; ?>app/Api/check_notifications.php')
    .then(response => response.json())
    .then(data => {
        if (data.error) return;

        const badge = document.getElementById('liveNotificationBadge');
        const list = document.getElementById('liveNotificationList');

        // Update the Dropdown HTML
        if (list && data.html) {
            list.innerHTML = data.html;
        }

        // Update the Red Dot
        if (badge) {
            if (data.count > 0) {
                // If there's a new message, pop the badge!
                badge.innerText = data.count;
                badge.classList.remove('d-none');
            } else {
                // If there are no messages, hide the badge!
                badge.classList.add('d-none');
            }
        }
    })
    .catch(err => console.error("Notification check failed:", err));
}

// Check for new messages every 10 seconds silently in the background
setInterval(checkLiveNotifications, 10000);
</script>

</body>

</html>